package  {		import flash.events.Event;		import flash.display.MovieClip;		import flash.media.Camera;	import flash.media.Video;		import flash.display.Bitmap;	import flash.display.FrameLabel;	import flash.display.BitmapData;	import flash.display.BlendMode;	import flash.utils.Timer;	import flash.events.TimerEvent;		public class BackgroundSubtraction extends MovieClip {				private var camW : int = 640;		private var camH : int = 480;				private var cam1:Camera;		private var cam2:Camera;				private var vid1:Video;		private var vid2:Video;				private var vid1_f0:BitmapData;		private var vid2_f0:BitmapData;				private var sub1:BitmapData;		private var sub2:BitmapData;				private var bitmap1:Bitmap;		private var bitmap2:Bitmap;				public function BackgroundSubtraction() {						addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);						vid1 = new Video(camW, camH);			vid2 = new Video(camW, camH);					}				public function onAddedToStage(event : Event) : void {						cam1 = Camera.getCamera("0");			cam2 = Camera.getCamera("1");						cam1.setMode(camW, camH, stage.frameRate);			cam2.setMode(camW, camH, stage.frameRate);						vid1.attachCamera(cam1);			vid2.attachCamera(cam2);						addEventListener(Event.ENTER_FRAME, onEnterFrameHandler);					}				private function takeBackground(eventObject:TimerEvent) : void {						vid1_f0.draw(vid1);			vid2_f0.draw(vid2);					}				private function onEnterFrameHandler(event : Event) : void {						if ( (sub1 == null) && !cam1.muted ) {								sub1 = new BitmapData(camW, camH);				sub2 = new BitmapData(camW, camH);								bitmap1 = new Bitmap(sub1);				bitmap2 = new Bitmap(sub2);								bitmap2.x = bitmap1.width;								this.addChild( bitmap1 );				this.addChild( bitmap2 );								vid1_f0 = new BitmapData(camW, camH);				vid2_f0 = new BitmapData(camW, camH);								var backgroundTimer:Timer = new Timer(1000, 1);				backgroundTimer.addEventListener(TimerEvent.TIMER, takeBackground);				backgroundTimer.start();							}						if ( (sub1 != null) && !cam1.muted ) {								sub1.draw(vid1);				sub1.draw(vid1_f0, null, null, BlendMode.SUBTRACT);								sub2.draw(vid2);				sub2.draw(vid2_f0, null, null, BlendMode.SUBTRACT);							}					}			}}